<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bebidas | ViSa Pizzaria</title>
    <link rel="stylesheet" href="main.css">
    <style>
        .modal-bg {
            display: none;
            position: fixed; inset: 0;
            background: rgba(0,0,0,0.5);
            justify-content: center; align-items: center;
            z-index: 1000;
        }
        .modal-bg.active { display: flex; }
        .modal {
            background: #fff;
            border-radius: 10px;
            padding: 24px 18px;
            max-width: 400px;
            width: 95vw;
            box-shadow: 0 4px 24px rgba(0,0,0,.18);
            position: relative;
            text-align: center;
        }
        .fechar-modal {
            position: absolute; top: 10px; right: 10px;
            background: none; border: none; font-size: 1.5rem; cursor: pointer;
        }
        .bebida-item {
            display: flex; align-items: center; gap: 10px; margin-bottom: 18px;
        }
        .bebida-item img {
            width: 60px; height: 60px; object-fit: cover; border-radius: 6px; background: #eee;
        }
        .bebida-info { flex: 1; text-align: left; }
        .bebida-info strong { font-size: 1.05em; }
        .bebida-info .preco { font-size: 0.95em; color: #555; }
        .btnMenos, .btnMais {
            padding: 4px 10px;
            background: #eee;
            border: none;
            border-radius: 4px;
            cursor: pointer;
        }
        .qtdInput {
            width: 36px;
            text-align: center;
        }
        .btnAddCarrinho {
            margin-left: 8px;
            background: #25d366;
            color: #fff;
            border: none;
            border-radius: 4px;
            padding: 4px 10px;
            cursor: pointer;
        }
    </style>
</head>
<body>
    <h1>Bebidas</h1>
    <ul id="bebidaCategorias">
        <li data-tipo="Refrigerante">ü•§ Refrigerantes</li>
        <li data-tipo="Cerveja">üç∫ Cervejas</li>
        <li data-tipo="Suco">üçπ Sucos</li>
        <li data-tipo="Ch√°">üçµ Ch√°s</li>
    </ul>

    <!-- Modal Global de Lista de Bebidas -->
    <div class="modal-bg" id="modalGlobal">
        <div class="modal">
            <button class="fechar-modal" id="fecharModalGlobal" aria-label="Fechar">‚úñÔ∏è</button>
            <h2 id="modalTitulo"></h2>
            <div id="modalListaBebidas"></div>
        </div>
    </div>

<script>
let carrinho = { bebidas: [] };

// Fun√ß√£o para abrir o modal com a lista de bebidas da categoria
async function abrirModalListaBebidas(tipo) {
    document.getElementById('modalTitulo').textContent = tipo + 's';
    document.getElementById('modalListaBebidas').innerHTML = 'Carregando...';

    // Busca bebidas da API
    const resp = await fetch('https://visa-pizzaria-backend.onrender.com/api/bebidas');
    const bebidas = await resp.json();
    const filtradas = bebidas.filter(b => b.tipo && b.tipo.toLowerCase() === tipo.toLowerCase());

    if (filtradas.length === 0) {
        document.getElementById('modalListaBebidas').innerHTML = '<p>Nenhuma bebida cadastrada.</p>';
    } else {
        document.getElementById('modalListaBebidas').innerHTML = filtradas.map((b, idx) => `
            <div class="bebida-item">
                <img src="https://visa-pizzaria-backend.onrender.com${b.imagem}" alt="${b.nome}">
                <div class="bebida-info">
                    <div><strong>${b.nome}</strong></div>
                    <div class="preco">R$ ${b.preco}</div>
                </div>
                <button class="btnMenos" data-idx="${idx}">-</button>
                <input type="number" min="1" value="1" class="qtdInput" data-idx="${idx}">
                <button class="btnMais" data-idx="${idx}">+</button>
                <button class="btnAddCarrinho" data-idx="${idx}">Adicionar</button>
            </div>
        `).join('');
    }

    // Eventos dos bot√µes +/-
    document.querySelectorAll('.btnMais').forEach(btn => {
        btn.onclick = () => {
            const idx = btn.dataset.idx;
            const input = document.querySelector(`.qtdInput[data-idx="${idx}"]`);
            input.value = parseInt(input.value) + 1;
        };
    });
    document.querySelectorAll('.btnMenos').forEach(btn => {
        btn.onclick = () => {
            const idx = btn.dataset.idx;
            const input = document.querySelector(`.qtdInput[data-idx="${idx}"]`);
            if (parseInt(input.value) > 1) input.value = parseInt(input.value) - 1;
        };
    });

    // Evento do bot√£o Adicionar ao Carrinho
    document.querySelectorAll('.btnAddCarrinho').forEach(btn => {
        btn.onclick = () => {
            const idx = btn.dataset.idx;
            const bebida = filtradas[idx];
            const qtd = parseInt(document.querySelector(`.qtdInput[data-idx="${idx}"]`).value) || 1;
            carrinho.bebidas.push({
                nome: bebida.nome,
                preco: bebida.preco,
                imagem: bebida.imagem,
                quantidade: qtd,
                subtotal: (qtd * (parseFloat(bebida.preco.replace(',', '.')) || 0)).toFixed(2).replace('.', ',')
            });
            alert('Adicionado ao carrinho!');
        };
    });

    document.getElementById('modalGlobal').classList.add('active');
}

// Fecha o modal
function fecharModalGlobal() {
    document.getElementById('modalGlobal').classList.remove('active');
}
document.getElementById('fecharModalGlobal').onclick = fecharModalGlobal;
document.getElementById('modalGlobal').onclick = function(e) {
    if (e.target === this) fecharModalGlobal();
};

// Ao clicar em cada categoria, abre o modal com a lista daquela categoria
document.querySelectorAll('#bebidaCategorias li').forEach(li => {
    li.onclick = function() {
        abrirModalListaBebidas(this.dataset.tipo);
    };
});
</script>
</body>